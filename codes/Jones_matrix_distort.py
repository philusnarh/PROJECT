import numpy as np
 #hdu1 = pyfits.open('beam_pattern_VOLTAGE.fits')
k = np.eye(2,2)
Jp = np.load('Jp.npy')
Jq = np.load('Jq.npy')
Jp1 = Jp.copy()
Jq1 = Jq.copy()
Jq1 = Jq1.reshape(512, 512, 481, 2,2)
r1 = np.kron(Jp1,k)
r2 = np.kron(k,Jq1)
Jpq = np.tensordot(r1, r2, axes=(2,2))
np.save('J_pq',Jpq)
A = np.array([(1, 0, 0, 1), (1, 0, 0, -1), (0, 1, 1, 0), (0, -1j, 1j, 0)])
A1 = np.linalg.inv(A)
M_ij = A*Jpq*A1
np.save('Mu_ij',M_ij)
